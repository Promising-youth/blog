概述
====

一直以为go和rust的跨平台是指在a平台编译的项目在b平台也可以运行，直到今天实践了一把，才知道还是自己太年轻。本来是想通过git来保存编译结果，之后在其他平台上直接运行，在mac上保存了下编译的结果，但在linux上运行不了，于是到开发群里寻求帮助，结果还被别人嘲讽了一波。

跨平台语言并不是说编译结果能跨平台执行，而是有能力编译出多平台产物。其实现今大部分语言都有跨平台的能力，完全跨平台的(不重新编译，跨平台运行)估计也只有java了。

那么如何在a平台上编译出b平台可以运行的项目，那么就需要交叉编译。

rust的交叉编译
==============

rust的交叉编译需要本地有相关的目标架构的库，通过rustup target
list可以列出所有的目标架构，一般来说我们的项目都会放到centos上，所以要得到该架构的目标编译结果，需要将该架构放到target中，执行下面的命令:

``` {.rust}
rust target add x86_64-unknown-linux-musl
```

所以你应该能明白了很多的rust的安装教程中，为什么都会出现这条命令，以及这条命令的含义了吧。
如果不安装目标架构的基础库，就无法编译出目标架构的可执行程序，在安装完后，执行以下命令:

``` {.rust}
cargo build --release --tartcargo build --release --target="x86_64-unknown-linux-musl"
```

有可能安装失败，可能的原因有可能是链接器等各种原因，总之交叉编译比较麻烦，有毅力的话可以做一些尝试。
安装musl-gcc : `brew install FiloSottile/musl-cross/musl-cross`
在.cargo/config中添加:

| \[target.x86~64~-unknown-linux-musl\]
| linker = \"x86~64~-linux-musl-gcc\"

之后再执行编译。

其他门路
========

其实完全不用这么大费周折，直接搞一个docker，在docker里编译并部署即可。
